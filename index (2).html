<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ripe FX Calculator - Transparent Stablecoin Conversion</title>
    <style>
        :root {
            --color-white: rgba(255, 255, 255, 1);
            --color-cream-50: rgba(252, 252, 249, 1);
            --color-cream-100: rgba(255, 255, 253, 1);
            --color-gray-200: rgba(245, 245, 245, 1);
            --color-gray-300: rgba(167, 169, 169, 1);
            --color-slate-500: rgba(98, 108, 113, 1);
            --color-brown-600: rgba(94, 82, 64, 1);
            --color-charcoal-700: rgba(31, 33, 33, 1);
            --color-charcoal-800: rgba(38, 40, 40, 1);
            --color-teal-300: rgba(50, 184, 198, 1);
            --color-teal-500: rgba(33, 128, 141, 1);
            --color-teal-600: rgba(29, 116, 128, 1);
            --color-teal-700: rgba(26, 104, 115, 1);
            --color-red-500: rgba(192, 21, 47, 1);
            --color-red-400: rgba(255, 84, 89, 1);
            
            --color-brown-600-rgb: 94, 82, 64;
            --color-teal-500-rgb: 33, 128, 141;
            --color-slate-900-rgb: 19, 52, 59;
            --color-gray-400-rgb: 119, 124, 124;
            --color-teal-300-rgb: 50, 184, 198;
            
            --color-background: var(--color-cream-50);
            --color-surface: var(--color-cream-100);
            --color-text: rgba(19, 52, 59, 1);
            --color-text-secondary: var(--color-slate-500);
            --color-primary: var(--color-teal-500);
            --color-primary-hover: var(--color-teal-600);
            --color-primary-active: var(--color-teal-700);
            --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
            --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
            --color-border: rgba(var(--color-brown-600-rgb), 0.2);
            --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
            --color-success: var(--color-teal-500);
            --color-success-rgb: 33, 128, 141;
            
            --font-family-base: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            --space-8: 8px;
            --space-12: 12px;
            --space-16: 16px;
            --space-20: 20px;
            --space-24: 24px;
            --radius-base: 8px;
            --radius-lg: 12px;
            --radius-full: 9999px;
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04), 0 4px 6px -2px rgba(0, 0, 0, 0.02);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --color-background: var(--color-charcoal-700);
                --color-surface: var(--color-charcoal-800);
                --color-text: var(--color-gray-200);
                --color-text-secondary: rgba(167, 169, 169, 0.7);
                --color-primary: var(--color-teal-300);
                --color-primary-hover: rgba(50, 184, 198, 1);
                --color-primary-active: rgba(41, 150, 161, 1);
                --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
                --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
                --color-border: rgba(var(--color-gray-400-rgb), 0.3);
                --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
                --color-success: var(--color-teal-300);
                --color-success-rgb: 50, 184, 198;
            }
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: var(--font-family-base);
            background: var(--color-background);
            color: var(--color-text);
            padding: var(--space-16);
            line-height: 1.5;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .widget-container {
            max-width: 480px;
            width: 100%;
            background: var(--color-surface);
            border-radius: var(--radius-lg);
            border: 1px solid var(--color-card-border);
            box-shadow: var(--shadow-lg);
            padding: var(--space-24);
        }

        .header {
            margin-bottom: var(--space-24);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--space-8);
            margin-bottom: var(--space-8);
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--color-primary), var(--color-teal-700));
            border-radius: var(--radius-base);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 18px;
        }

        .logo-text {
            font-size: 20px;
            font-weight: 600;
            color: var(--color-text);
        }

        .tagline {
            font-size: 14px;
            color: var(--color-text-secondary);
            margin-bottom: var(--space-16);
        }

        .direction-toggle {
            display: flex;
            background: var(--color-secondary);
            border-radius: var(--radius-base);
            padding: 4px;
            gap: 4px;
        }

        .direction-btn {
            flex: 1;
            padding: var(--space-8) var(--space-12);
            background: transparent;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            color: var(--color-text);
            cursor: pointer;
            transition: all 0.2s;
        }

        .direction-btn.active {
            background: var(--color-surface);
            color: var(--color-primary);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .input-section {
            margin: var(--space-20) 0;
        }

        .input-group {
            margin-bottom: var(--space-16);
        }

        .input-label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: var(--color-text-secondary);
            margin-bottom: var(--space-8);
        }

        .input-wrapper {
            display: flex;
            align-items: center;
            gap: var(--space-8);
        }

        .input-field {
            flex: 1;
            padding: var(--space-12);
            font-size: 18px;
            font-weight: 600;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            background: var(--color-surface);
            color: var(--color-text);
            transition: border-color 0.2s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        .currency-select {
            padding: var(--space-12);
            font-size: 16px;
            font-weight: 600;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            background: var(--color-surface);
            color: var(--color-text);
            cursor: pointer;
            min-width: 100px;
        }

        .currency-select:focus {
            outline: none;
            border-color: var(--color-primary);
        }

        .preset-buttons {
            display: flex;
            gap: var(--space-8);
            margin-top: var(--space-8);
        }

        .preset-btn {
            flex: 1;
            padding: var(--space-8);
            background: var(--color-secondary);
            border: 1px solid var(--color-border);
            border-radius: var(--radius-base);
            font-size: 13px;
            font-weight: 500;
            color: var(--color-text);
            cursor: pointer;
            transition: all 0.2s;
        }

        .preset-btn:hover {
            background: var(--color-secondary-hover);
        }

        .result-card {
            background: linear-gradient(135deg, rgba(var(--color-success-rgb), 0.08), rgba(var(--color-success-rgb), 0.04));
            border: 1px solid rgba(var(--color-success-rgb), 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-20);
            margin: var(--space-20) 0;
        }

        .result-headline {
            font-size: 14px;
            color: var(--color-text-secondary);
            margin-bottom: var(--space-8);
        }

        .result-amount {
            font-size: 32px;
            font-weight: 700;
            color: var(--color-success);
            margin-bottom: var(--space-8);
        }

        .result-subtext {
            font-size: 13px;
            color: var(--color-text-secondary);
        }

        .breakdown-section {
            margin-top: var(--space-20);
        }

        .breakdown-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-16);
        }

        .breakdown-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--color-text);
        }

        .toggle-details {
            background: none;
            border: none;
            color: var(--color-primary);
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .toggle-details:hover {
            color: var(--color-primary-hover);
        }

        .breakdown-item {
            display: flex;
            justify-content: space-between;
            padding: var(--space-12) 0;
            border-bottom: 1px solid var(--color-border);
        }

        .breakdown-item:last-child {
            border-bottom: none;
        }

        .breakdown-label {
            font-size: 14px;
            color: var(--color-text);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .breakdown-value {
            font-size: 14px;
            font-weight: 600;
            color: var(--color-text);
            text-align: right;
        }

        .breakdown-value.negative {
            color: var(--color-red-500);
        }

        .breakdown-value.positive {
            color: var(--color-success);
        }

        .info-icon {
            display: inline-block;
            width: 14px;
            height: 14px;
            background: var(--color-text-secondary);
            color: var(--color-surface);
            border-radius: 50%;
            font-size: 10px;
            font-weight: 700;
            line-height: 14px;
            text-align: center;
            cursor: help;
        }

        .detail-math {
            font-size: 12px;
            color: var(--color-text-secondary);
            background: var(--color-secondary);
            padding: var(--space-12);
            border-radius: var(--radius-base);
            margin-top: var(--space-8);
            display: none;
        }

        .detail-math.show {
            display: block;
        }

        .comparison-section {
            margin-top: var(--space-24);
            padding-top: var(--space-20);
            border-top: 2px solid var(--color-border);
        }

        .comparison-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--color-text);
            margin-bottom: var(--space-12);
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: var(--space-12);
        }

        .comparison-card {
            padding: var(--space-16);
            background: var(--color-secondary);
            border-radius: var(--radius-base);
            border: 1px solid var(--color-border);
        }

        .comparison-card.ripe {
            background: linear-gradient(135deg, rgba(var(--color-success-rgb), 0.08), rgba(var(--color-success-rgb), 0.04));
            border-color: rgba(var(--color-success-rgb), 0.3);
        }

        .comparison-label {
            font-size: 12px;
            font-weight: 500;
            color: var(--color-text-secondary);
            margin-bottom: 6px;
        }

        .comparison-amount {
            font-size: 18px;
            font-weight: 700;
            color: var(--color-text);
        }

        .comparison-card.ripe .comparison-amount {
            color: var(--color-success);
        }

        .comparison-fees {
            font-size: 11px;
            color: var(--color-text-secondary);
            margin-top: 4px;
        }

        .footer-note {
            margin-top: var(--space-20);
            padding-top: var(--space-16);
            border-top: 1px solid var(--color-border);
            font-size: 11px;
            color: var(--color-text-secondary);
            text-align: center;
        }

        @media (max-width: 400px) {
            .widget-container {
                padding: var(--space-16);
            }

            .result-amount {
                font-size: 28px;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="widget-container">
        <div class="header">
            <div class="logo">
                <div class="logo-icon">R</div>
                <div class="logo-text">Ripe</div>
            </div>
            <div class="tagline">Transparent stablecoin conversion for Southeast Asia</div>
            
            <div class="direction-toggle">
                <button class="direction-btn active" id="sendBtn">Send</button>
                <button class="direction-btn" id="receiveBtn">Receive</button>
            </div>
        </div>

        <div class="input-section">
            <div class="input-group">
                <label class="input-label" id="inputLabel">You send</label>
                <div class="input-wrapper">
                    <input 
                        type="number" 
                        class="input-field" 
                        id="amountInput" 
                        value="100" 
                        min="0.01" 
                        step="0.01"
                        placeholder="0.00"
                    >
                    <span style="font-size: 16px; font-weight: 600; color: var(--color-text);">USDC</span>
                </div>
                <div class="preset-buttons">
                    <button class="preset-btn" data-amount="10">10</button>
                    <button class="preset-btn" data-amount="50">50</button>
                    <button class="preset-btn" data-amount="100">100</button>
                    <button class="preset-btn" data-amount="250">250</button>
                </div>
            </div>

            <div class="input-group">
                <label class="input-label" id="outputLabel">Recipient gets</label>
                <div class="input-wrapper">
                    <select class="currency-select" id="currencySelect">
                        <option value="PHP">PHP - Philippine Peso</option>
                        <option value="THB">THB - Thai Baht</option>
                        <option value="IDR">IDR - Indonesian Rupiah</option>
                        <option value="MYR">MYR - Malaysian Ringgit</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="result-card">
            <div class="result-headline" id="resultHeadline">Recipient receives</div>
            <div class="result-amount" id="resultAmount">₱5,765.00</div>
            <div class="result-subtext" id="resultSubtext">From 100.00 USDC</div>
        </div>

        <div class="breakdown-section">
            <div class="breakdown-header">
                <div class="breakdown-title">Fee Breakdown</div>
                <button class="toggle-details" id="toggleDetails">
                    Show details
                    <span id="detailsArrow">▼</span>
                </button>
            </div>

            <div class="breakdown-item">
                <div class="breakdown-label">
                    Gross amount
                    <span class="info-icon" title="Amount before fees at customer rate">i</span>
                </div>
                <div class="breakdown-value" id="grossAmount">₱5,850.00</div>
            </div>

            <div class="breakdown-item">
                <div class="breakdown-label">
                    Ripe fee (0.5%)
                    <span class="info-icon" title="Transaction processing fee">i</span>
                </div>
                <div class="breakdown-value negative" id="ripeFee">-₱29.25</div>
            </div>

            <div class="breakdown-item">
                <div class="breakdown-label">
                    Network fee
                    <span class="info-icon" title="Blockchain transaction cost">i</span>
                </div>
                <div class="breakdown-value negative" id="networkFee">-₱117.00</div>
            </div>

            <div class="breakdown-item">
                <div class="breakdown-label">
                    FX spread (0.85%)
                    <span class="info-icon" title="Difference from interbank rate">i</span>
                </div>
                <div class="breakdown-value" id="fxSpread">Already included</div>
            </div>

            <div class="detail-math" id="detailMath">
                <strong>Detailed Calculation:</strong><br>
                Interbank rate: 1 USDC = <span id="interbankRate">59.00</span> <span id="currencyCode">PHP</span><br>
                Customer rate: 1 USDC = <span id="customerRate">58.50</span> <span id="currencyCode2">PHP</span><br>
                FX spread: <span id="spreadPercent">0.85%</span><br><br>
                
                <span id="amountValue">100.00</span> USDC × <span id="customerRate2">58.50</span> = <span id="grossValue">5,850.00</span><br>
                Ripe fee: <span id="grossValue2">5,850.00</span> × 0.5% = <span id="ripeFeeValue">29.25</span><br>
                Network fee: ~$2.00 ≈ <span id="networkFeeValue">117.00</span><br>
                Net received: <span id="grossValue3">5,850.00</span> - <span id="ripeFeeValue2">29.25</span> - <span id="networkFeeValue2">117.00</span> = <span id="netValue">5,703.75</span>
            </div>
        </div>

        <div class="comparison-section">
            <div class="comparison-title">Compare with traditional providers</div>
            <div class="comparison-grid">
                <div class="comparison-card">
                    <div class="comparison-label">Legacy Provider</div>
                    <div class="comparison-amount" id="legacyAmount">₱5,400.00</div>
                    <div class="comparison-fees">~8% in hidden fees</div>
                </div>
                <div class="comparison-card ripe">
                    <div class="comparison-label">Ripe</div>
                    <div class="comparison-amount" id="ripeAmount">₱5,765.00</div>
                    <div class="comparison-fees">Full transparency</div>
                </div>
            </div>
        </div>

        <div class="footer-note">
            Rates update in real-time. This is a calculator for estimation purposes.
        </div>
    </div>

    <script>
        // Exchange rate configuration with mock but competitive rates
        const exchangeRates = {
            PHP: {
                interbank: 59.00,
                customerRate: 58.50,
                symbol: '₱',
                decimals: 2,
                name: 'PHP'
            },
            THB: {
                interbank: 36.50,
                customerRate: 36.15,
                symbol: '฿',
                decimals: 2,
                name: 'THB'
            },
            IDR: {
                interbank: 15800,
                customerRate: 15650,
                symbol: 'Rp',
                decimals: 0,
                name: 'IDR'
            },
            MYR: {
                interbank: 4.70,
                customerRate: 4.66,
                symbol: 'RM',
                decimals: 2,
                name: 'MYR'
            }
        };

        // Fee configuration
        const fees = {
            transactionPercent: 0.005, // 0.5%
            networkFeeUSD: 2.00 // ~$2 network fee
        };

        // State management
        let currentDirection = 'send'; // 'send' or 'receive'
        let currentCurrency = 'PHP';
        let currentAmount = 100;

        // DOM elements
        const amountInput = document.getElementById('amountInput');
        const currencySelect = document.getElementById('currencySelect');
        const sendBtn = document.getElementById('sendBtn');
        const receiveBtn = document.getElementById('receiveBtn');
        const toggleDetailsBtn = document.getElementById('toggleDetails');
        const detailMath = document.getElementById('detailMath');
        const detailsArrow = document.getElementById('detailsArrow');

        // Format currency with proper symbols and decimals
        function formatCurrency(amount, currency) {
            const config = exchangeRates[currency];
            const formatted = amount.toFixed(config.decimals).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            return `${config.symbol}${formatted}`;
        }

        // Calculate FX spread percentage
        function calculateSpreadPercent(currency) {
            const config = exchangeRates[currency];
            const spread = ((config.interbank - config.customerRate) / config.interbank) * 100;
            return spread.toFixed(2);
        }

        // Main calculation function
        function calculateConversion() {
            const currency = currentCurrency;
            const config = exchangeRates[currency];
            const usdcAmount = parseFloat(amountInput.value) || 0;

            // Step 1: Gross fiat amount at customer rate
            const grossFiat = usdcAmount * config.customerRate;

            // Step 2: Ripe transaction fee (0.5% of gross fiat)
            const ripeFee = grossFiat * fees.transactionPercent;

            // Step 3: Network fee (~$2 converted to local currency)
            const networkFee = fees.networkFeeUSD * config.customerRate;

            // Step 4: Net fiat received
            const netFiat = grossFiat - ripeFee - networkFee;

            // Legacy provider comparison (typical 8% in total fees/spread)
            const legacyNet = grossFiat * 0.92;

            // Update UI
            updateDisplay(usdcAmount, grossFiat, ripeFee, networkFee, netFiat, legacyNet, currency, config);
        }

        // Update all display elements
        function updateDisplay(usdcAmount, grossFiat, ripeFee, networkFee, netFiat, legacyNet, currency, config) {
            // Result card
            document.getElementById('resultAmount').textContent = formatCurrency(netFiat, currency);
            document.getElementById('resultSubtext').textContent = `From ${usdcAmount.toFixed(2)} USDC`;

            // Breakdown
            document.getElementById('grossAmount').textContent = formatCurrency(grossFiat, currency);
            document.getElementById('ripeFee').textContent = `-${formatCurrency(ripeFee, currency)}`;
            document.getElementById('networkFee').textContent = `-${formatCurrency(networkFee, currency)}`;

            // Detailed math
            const spreadPercent = calculateSpreadPercent(currency);
            document.getElementById('interbankRate').textContent = config.interbank.toFixed(2);
            document.getElementById('customerRate').textContent = config.customerRate.toFixed(2);
            document.getElementById('customerRate2').textContent = config.customerRate.toFixed(2);
            document.getElementById('spreadPercent').textContent = `${spreadPercent}%`;
            document.getElementById('amountValue').textContent = usdcAmount.toFixed(2);
            document.getElementById('grossValue').textContent = grossFiat.toFixed(2);
            document.getElementById('grossValue2').textContent = grossFiat.toFixed(2);
            document.getElementById('grossValue3').textContent = grossFiat.toFixed(2);
            document.getElementById('ripeFeeValue').textContent = ripeFee.toFixed(2);
            document.getElementById('ripeFeeValue2').textContent = ripeFee.toFixed(2);
            document.getElementById('networkFeeValue').textContent = networkFee.toFixed(2);
            document.getElementById('networkFeeValue2').textContent = networkFee.toFixed(2);
            document.getElementById('netValue').textContent = netFiat.toFixed(2);

            // Update currency codes in detail math
            const currencyCodes = document.querySelectorAll('#currencyCode, #currencyCode2');
            currencyCodes.forEach(el => el.textContent = currency);

            // Comparison section
            document.getElementById('legacyAmount').textContent = formatCurrency(legacyNet, currency);
            document.getElementById('ripeAmount').textContent = formatCurrency(netFiat, currency);
        }

        // Event listeners
        amountInput.addEventListener('input', calculateConversion);

        currencySelect.addEventListener('change', (e) => {
            currentCurrency = e.target.value;
            calculateConversion();
        });

        // Preset buttons
        document.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const amount = parseFloat(e.target.dataset.amount);
                amountInput.value = amount;
                calculateConversion();
            });
        });

        // Direction toggle
        sendBtn.addEventListener('click', () => {
            if (currentDirection !== 'send') {
                currentDirection = 'send';
                sendBtn.classList.add('active');
                receiveBtn.classList.remove('active');
                document.getElementById('inputLabel').textContent = 'You send';
                document.getElementById('outputLabel').textContent = 'Recipient gets';
                document.getElementById('resultHeadline').textContent = 'Recipient receives';
            }
        });

        receiveBtn.addEventListener('click', () => {
            if (currentDirection !== 'receive') {
                currentDirection = 'receive';
                receiveBtn.classList.add('active');
                sendBtn.classList.remove('active');
                document.getElementById('inputLabel').textContent = 'Recipient gets';
                document.getElementById('outputLabel').textContent = 'You send';
                document.getElementById('resultHeadline').textContent = 'You need to send';
            }
        });

        // Toggle detailed math
        toggleDetailsBtn.addEventListener('click', () => {
            detailMath.classList.toggle('show');
            const isShowing = detailMath.classList.contains('show');
            toggleDetailsBtn.innerHTML = isShowing 
                ? 'Hide details <span id="detailsArrow">▲</span>'
                : 'Show details <span id="detailsArrow">▼</span>';
        });

        // Initial calculation
        calculateConversion();
    </script>
</body>
</html>

